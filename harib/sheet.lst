     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_memman_alloc_4k
     7 00000000                                 [FILE "sheet.c"]
     8                                          [SECTION .text]
     9 00000000                                 	GLOBAL	_shtctl_init
    10 00000000                                 _shtctl_init:
    11 00000000 55                              	PUSH	EBP
    12 00000001 89 E5                           	MOV	EBP,ESP
    13 00000003 68 00002810                     	PUSH	10256
    14 00000008 FF 75 08                        	PUSH	DWORD [8+EBP]
    15 0000000B E8 [00000000]                   	CALL	_memman_alloc_4k
    16 00000010 89 C2                           	MOV	EDX,EAX
    17 00000012 58                              	POP	EAX
    18 00000013 59                              	POP	ECX
    19 00000014 85 D2                           	TEST	EDX,EDX
    20 00000016 74 37                           	JE	L3
    21 00000018 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
    22 0000001B 8D 8A 000023DC                  	LEA	ECX,DWORD [9180+EDX]
    23 00000021 89 02                           	MOV	DWORD [EDX],EAX
    24 00000023 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
    25 00000026 89 42 04                        	MOV	DWORD [4+EDX],EAX
    26 00000029 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
    27 0000002C 89 42 08                        	MOV	DWORD [8+EDX],EAX
    28 0000002F 89 D0                           	MOV	EAX,EDX
    29 00000031 C7 42 0C FFFFFFFF               	MOV	DWORD [12+EDX],-1
    30 00000038                                 L8:
    31 00000038 C7 80 0000042C 00000000         	MOV	DWORD [1068+EAX],0
    32 00000042 89 90 00000430                  	MOV	DWORD [1072+EAX],EDX
    33 00000048 83 C0 24                        	ADD	EAX,36
    34 0000004B 39 C8                           	CMP	EAX,ECX
    35 0000004D 7E E9                           	JLE	L8
    36 0000004F                                 L3:
    37 0000004F 89 D0                           	MOV	EAX,EDX
    38 00000051 C9                              	LEAVE
    39 00000052 C3                              	RET
    40 00000053                                 	GLOBAL	_sheet_alloc
    41 00000053                                 _sheet_alloc:
    42 00000053 55                              	PUSH	EBP
    43 00000054 31 D2                           	XOR	EDX,EDX
    44 00000056 89 E5                           	MOV	EBP,ESP
    45 00000058 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
    46 0000005B 05 00000410                     	ADD	EAX,1040
    47 00000060                                 L16:
    48 00000060 83 78 1C 00                     	CMP	DWORD [28+EAX],0
    49 00000064 74 10                           	JE	L19
    50 00000066 42                              	INC	EDX
    51 00000067 83 C0 24                        	ADD	EAX,36
    52 0000006A 81 FA 000000FF                  	CMP	EDX,255
    53 00000070 7E EE                           	JLE	L16
    54 00000072 31 C0                           	XOR	EAX,EAX
    55 00000074                                 L10:
    56 00000074 5D                              	POP	EBP
    57 00000075 C3                              	RET
    58 00000076                                 L19:
    59 00000076 C7 40 1C 00000001               	MOV	DWORD [28+EAX],1
    60 0000007D C7 40 18 FFFFFFFF               	MOV	DWORD [24+EAX],-1
    61 00000084 EB EE                           	JMP	L10
    62 00000086                                 	GLOBAL	_sheet_setbuf
    63 00000086                                 _sheet_setbuf:
    64 00000086 55                              	PUSH	EBP
    65 00000087 89 E5                           	MOV	EBP,ESP
    66 00000089 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
    67 0000008C 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
    68 0000008F 89 02                           	MOV	DWORD [EDX],EAX
    69 00000091 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
    70 00000094 89 42 04                        	MOV	DWORD [4+EDX],EAX
    71 00000097 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
    72 0000009A 89 42 08                        	MOV	DWORD [8+EDX],EAX
    73 0000009D 8B 45 18                        	MOV	EAX,DWORD [24+EBP]
    74 000000A0 89 42 14                        	MOV	DWORD [20+EDX],EAX
    75 000000A3 5D                              	POP	EBP
    76 000000A4 C3                              	RET
    77 000000A5                                 	GLOBAL	_sheet_updown
    78 000000A5                                 _sheet_updown:
    79 000000A5 55                              	PUSH	EBP
    80 000000A6 89 E5                           	MOV	EBP,ESP
    81 000000A8 57                              	PUSH	EDI
    82 000000A9 56                              	PUSH	ESI
    83 000000AA 8B 7D 08                        	MOV	EDI,DWORD [8+EBP]
    84 000000AD 53                              	PUSH	EBX
    85 000000AE 8B 5D 0C                        	MOV	EBX,DWORD [12+EBP]
    86 000000B1 8B 77 20                        	MOV	ESI,DWORD [32+EDI]
    87 000000B4 8B 47 18                        	MOV	EAX,DWORD [24+EDI]
    88 000000B7 8B 56 0C                        	MOV	EDX,DWORD [12+ESI]
    89 000000BA 42                              	INC	EDX
    90 000000BB 39 D3                           	CMP	EBX,EDX
    91 000000BD 7E 02                           	JLE	L22
    92 000000BF 89 D3                           	MOV	EBX,EDX
    93 000000C1                                 L22:
    94 000000C1 83 FB FF                        	CMP	EBX,-1
    95 000000C4 7D 03                           	JGE	L23
    96 000000C6 83 CB FF                        	OR	EBX,-1
    97 000000C9                                 L23:
    98 000000C9 89 5F 18                        	MOV	DWORD [24+EDI],EBX
    99 000000CC 39 D8                           	CMP	EAX,EBX
   100 000000CE 0F 8E 00000085                  	JLE	L24
   101 000000D4 85 DB                           	TEST	EBX,EBX
   102 000000D6 78 5E                           	JS	L25
   103 000000D8 89 C1                           	MOV	ECX,EAX
   104 000000DA                                 L30:
   105 000000DA 8B 44 8E 0C                     	MOV	EAX,DWORD [12+ESI+ECX*4]
   106 000000DE 89 44 8E 10                     	MOV	DWORD [16+ESI+ECX*4],EAX
   107 000000E2 89 48 18                        	MOV	DWORD [24+EAX],ECX
   108 000000E5 49                              	DEC	ECX
   109 000000E6 39 D9                           	CMP	ECX,EBX
   110 000000E8 7F F0                           	JG	L30
   111 000000EA 8D 43 01                        	LEA	EAX,DWORD [1+EBX]
   112 000000ED 89 7C 9E 10                     	MOV	DWORD [16+ESI+EBX*4],EDI
   113 000000F1 50                              	PUSH	EAX
   114 000000F2 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   115 000000F5 89 C8                           	MOV	EAX,ECX
   116 000000F7 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   117 000000FA 50                              	PUSH	EAX
   118 000000FB 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   119 000000FE 89 D0                           	MOV	EAX,EDX
   120 00000100 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   121 00000103 50                              	PUSH	EAX
   122 00000104 51                              	PUSH	ECX
   123 00000105 52                              	PUSH	EDX
   124 00000106 56                              	PUSH	ESI
   125 00000107 E8 000000CE                     	CALL	_sheet_refreshsub
   126 0000010C 83 C4 18                        	ADD	ESP,24
   127 0000010F                                 L31:
   128 0000010F 6A 00                           	PUSH	0
   129 00000111                                 L59:
   130 00000111 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   131 00000114 89 C8                           	MOV	EAX,ECX
   132 00000116 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   133 00000119 50                              	PUSH	EAX
   134 0000011A 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   135 0000011D 89 D0                           	MOV	EAX,EDX
   136 0000011F 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   137 00000122 50                              	PUSH	EAX
   138 00000123 51                              	PUSH	ECX
   139 00000124 52                              	PUSH	EDX
   140 00000125 56                              	PUSH	ESI
   141 00000126 E8 000000AF                     	CALL	_sheet_refreshsub
   142 0000012B 83 C4 18                        	ADD	ESP,24
   143 0000012E                                 L21:
   144 0000012E 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   145 00000131 5B                              	POP	EBX
   146 00000132 5E                              	POP	ESI
   147 00000133 5F                              	POP	EDI
   148 00000134 5D                              	POP	EBP
   149 00000135 C3                              	RET
   150 00000136                                 L25:
   151 00000136 8B 56 0C                        	MOV	EDX,DWORD [12+ESI]
   152 00000139 39 C2                           	CMP	EDX,EAX
   153 0000013B 7E 17                           	JLE	L32
   154 0000013D 89 C1                           	MOV	ECX,EAX
   155 0000013F 39 D0                           	CMP	EAX,EDX
   156 00000141 7D 11                           	JGE	L32
   157 00000143                                 L37:
   158 00000143 8B 44 8E 14                     	MOV	EAX,DWORD [20+ESI+ECX*4]
   159 00000147 89 44 8E 10                     	MOV	DWORD [16+ESI+ECX*4],EAX
   160 0000014B 89 48 18                        	MOV	DWORD [24+EAX],ECX
   161 0000014E 41                              	INC	ECX
   162 0000014F 3B 4E 0C                        	CMP	ECX,DWORD [12+ESI]
   163 00000152 7C EF                           	JL	L37
   164 00000154                                 L32:
   165 00000154 FF 4E 0C                        	DEC	DWORD [12+ESI]
   166 00000157 EB B6                           	JMP	L31
   167 00000159                                 L24:
   168 00000159 39 D8                           	CMP	EAX,EBX
   169 0000015B 7D D1                           	JGE	L21
   170 0000015D 85 C0                           	TEST	EAX,EAX
   171 0000015F 78 1D                           	JS	L40
   172 00000161 89 C1                           	MOV	ECX,EAX
   173 00000163 39 D8                           	CMP	EAX,EBX
   174 00000165 7D 10                           	JGE	L56
   175 00000167                                 L45:
   176 00000167 8B 44 8E 14                     	MOV	EAX,DWORD [20+ESI+ECX*4]
   177 0000016B 89 44 8E 10                     	MOV	DWORD [16+ESI+ECX*4],EAX
   178 0000016F 89 48 18                        	MOV	DWORD [24+EAX],ECX
   179 00000172 41                              	INC	ECX
   180 00000173 39 D9                           	CMP	ECX,EBX
   181 00000175 7C F0                           	JL	L45
   182 00000177                                 L56:
   183 00000177 89 7C 9E 10                     	MOV	DWORD [16+ESI+EBX*4],EDI
   184 0000017B                                 L46:
   185 0000017B 53                              	PUSH	EBX
   186 0000017C EB 93                           	JMP	L59
   187 0000017E                                 L40:
   188 0000017E 8B 4E 0C                        	MOV	ECX,DWORD [12+ESI]
   189 00000181 39 D9                           	CMP	ECX,EBX
   190 00000183 7C 13                           	JL	L58
   191 00000185                                 L51:
   192 00000185 8B 54 8E 10                     	MOV	EDX,DWORD [16+ESI+ECX*4]
   193 00000189 8D 41 01                        	LEA	EAX,DWORD [1+ECX]
   194 0000018C 89 54 8E 14                     	MOV	DWORD [20+ESI+ECX*4],EDX
   195 00000190 49                              	DEC	ECX
   196 00000191 89 42 18                        	MOV	DWORD [24+EDX],EAX
   197 00000194 39 D9                           	CMP	ECX,EBX
   198 00000196 7D ED                           	JGE	L51
   199 00000198                                 L58:
   200 00000198 89 7C 9E 10                     	MOV	DWORD [16+ESI+EBX*4],EDI
   201 0000019C FF 46 0C                        	INC	DWORD [12+ESI]
   202 0000019F EB DA                           	JMP	L46
   203 000001A1                                 	GLOBAL	_sheet_refresh
   204 000001A1                                 _sheet_refresh:
   205 000001A1 55                              	PUSH	EBP
   206 000001A2 89 E5                           	MOV	EBP,ESP
   207 000001A4 53                              	PUSH	EBX
   208 000001A5 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   209 000001A8 8B 43 18                        	MOV	EAX,DWORD [24+EBX]
   210 000001AB 85 C0                           	TEST	EAX,EAX
   211 000001AD 78 26                           	JS	L60
   212 000001AF 50                              	PUSH	EAX
   213 000001B0 8B 4B 10                        	MOV	ECX,DWORD [16+EBX]
   214 000001B3 89 C8                           	MOV	EAX,ECX
   215 000001B5 03 4D 10                        	ADD	ECX,DWORD [16+EBP]
   216 000001B8 03 45 18                        	ADD	EAX,DWORD [24+EBP]
   217 000001BB 50                              	PUSH	EAX
   218 000001BC 8B 53 0C                        	MOV	EDX,DWORD [12+EBX]
   219 000001BF 89 D0                           	MOV	EAX,EDX
   220 000001C1 03 55 0C                        	ADD	EDX,DWORD [12+EBP]
   221 000001C4 03 45 14                        	ADD	EAX,DWORD [20+EBP]
   222 000001C7 50                              	PUSH	EAX
   223 000001C8 51                              	PUSH	ECX
   224 000001C9 52                              	PUSH	EDX
   225 000001CA FF 73 20                        	PUSH	DWORD [32+EBX]
   226 000001CD E8 00000008                     	CALL	_sheet_refreshsub
   227 000001D2 83 C4 18                        	ADD	ESP,24
   228 000001D5                                 L60:
   229 000001D5 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
   230 000001D8 C9                              	LEAVE
   231 000001D9 C3                              	RET
   232 000001DA                                 	GLOBAL	_sheet_refreshsub
   233 000001DA                                 _sheet_refreshsub:
   234 000001DA 55                              	PUSH	EBP
   235 000001DB 89 E5                           	MOV	EBP,ESP
   236 000001DD 57                              	PUSH	EDI
   237 000001DE 56                              	PUSH	ESI
   238 000001DF 53                              	PUSH	EBX
   239 000001E0 83 EC 18                        	SUB	ESP,24
   240 000001E3 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   241 000001E6 83 7D 0C 00                     	CMP	DWORD [12+EBP],0
   242 000001EA 8B 00                           	MOV	EAX,DWORD [EAX]
   243 000001EC 89 45 E4                        	MOV	DWORD [-28+EBP],EAX
   244 000001EF 0F 88 000000E6                  	JS	L94
   245 000001F5                                 L63:
   246 000001F5 83 7D 10 00                     	CMP	DWORD [16+EBP],0
   247 000001F9 0F 88 000000D0                  	JS	L95
   248 000001FF                                 L64:
   249 000001FF 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   250 00000202 8B 42 04                        	MOV	EAX,DWORD [4+EDX]
   251 00000205 39 45 14                        	CMP	DWORD [20+EBP],EAX
   252 00000208 7E 03                           	JLE	L65
   253 0000020A 89 45 14                        	MOV	DWORD [20+EBP],EAX
   254 0000020D                                 L65:
   255 0000020D 8B 4D 08                        	MOV	ECX,DWORD [8+EBP]
   256 00000210 8B 41 08                        	MOV	EAX,DWORD [8+ECX]
   257 00000213 39 45 18                        	CMP	DWORD [24+EBP],EAX
   258 00000216 7E 03                           	JLE	L66
   259 00000218 89 45 18                        	MOV	DWORD [24+EBP],EAX
   260 0000021B                                 L66:
   261 0000021B 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   262 0000021E 8B 7D 1C                        	MOV	EDI,DWORD [28+EBP]
   263 00000221 3B 7B 0C                        	CMP	EDI,DWORD [12+EBX]
   264 00000224 0F 8F 0000009D                  	JG	L89
   265 0000022A                                 L87:
   266 0000022A 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   267 0000022D 31 DB                           	XOR	EBX,EBX
   268 0000022F C7 45 EC 00000000               	MOV	DWORD [-20+EBP],0
   269 00000236 8B 54 B8 10                     	MOV	EDX,DWORD [16+EAX+EDI*4]
   270 0000023A 8B 0A                           	MOV	ECX,DWORD [EDX]
   271 0000023C 3B 5A 08                        	CMP	EBX,DWORD [8+EDX]
   272 0000023F 89 4D E8                        	MOV	DWORD [-24+EBP],ECX
   273 00000242 7D 76                           	JGE	L91
   274 00000244                                 L86:
   275 00000244 8B 75 EC                        	MOV	ESI,DWORD [-20+EBP]
   276 00000247 8B 42 04                        	MOV	EAX,DWORD [4+EDX]
   277 0000024A C7 45 F0 00000000               	MOV	DWORD [-16+EBP],0
   278 00000251 03 72 10                        	ADD	ESI,DWORD [16+EDX]
   279 00000254 39 45 F0                        	CMP	DWORD [-16+EBP],EAX
   280 00000257 7D 56                           	JGE	L93
   281 00000259                                 L85:
   282 00000259 8B 4D F0                        	MOV	ECX,DWORD [-16+EBP]
   283 0000025C 03 4A 0C                        	ADD	ECX,DWORD [12+EDX]
   284 0000025F 39 4D 0C                        	CMP	DWORD [12+EBP],ECX
   285 00000262 7F 40                           	JG	L81
   286 00000264 3B 4D 14                        	CMP	ECX,DWORD [20+EBP]
   287 00000267 7D 3B                           	JGE	L81
   288 00000269 39 75 10                        	CMP	DWORD [16+EBP],ESI
   289 0000026C 7F 36                           	JG	L81
   290 0000026E 3B 75 18                        	CMP	ESI,DWORD [24+EBP]
   291 00000271 7D 31                           	JGE	L81
   292 00000273 8B 5D EC                        	MOV	EBX,DWORD [-20+EBP]
   293 00000276 0F AF D8                        	IMUL	EBX,EAX
   294 00000279 03 5D F0                        	ADD	EBX,DWORD [-16+EBP]
   295 0000027C 8B 45 E8                        	MOV	EAX,DWORD [-24+EBP]
   296 0000027F 8A 1C 03                        	MOV	BL,BYTE [EBX+EAX*1]
   297 00000282 0F B6 C3                        	MOVZX	EAX,BL
   298 00000285 88 5D DF                        	MOV	BYTE [-33+EBP],BL
   299 00000288 3B 42 14                        	CMP	EAX,DWORD [20+EDX]
   300 0000028B 74 17                           	JE	L81
   301 0000028D 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   302 00000290 89 F0                           	MOV	EAX,ESI
   303 00000292 0F AF 43 04                     	IMUL	EAX,DWORD [4+EBX]
   304 00000296 8B 5D E4                        	MOV	EBX,DWORD [-28+EBP]
   305 00000299 89 45 E0                        	MOV	DWORD [-32+EBP],EAX
   306 0000029C 01 C8                           	ADD	EAX,ECX
   307 0000029E 8A 4D DF                        	MOV	CL,BYTE [-33+EBP]
   308 000002A1 88 0C 18                        	MOV	BYTE [EAX+EBX*1],CL
   309 000002A4                                 L81:
   310 000002A4 8B 42 04                        	MOV	EAX,DWORD [4+EDX]
   311 000002A7 FF 45 F0                        	INC	DWORD [-16+EBP]
   312 000002AA 39 45 F0                        	CMP	DWORD [-16+EBP],EAX
   313 000002AD 7C AA                           	JL	L85
   314 000002AF                                 L93:
   315 000002AF FF 45 EC                        	INC	DWORD [-20+EBP]
   316 000002B2 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   317 000002B5 3B 42 08                        	CMP	EAX,DWORD [8+EDX]
   318 000002B8 7C 8A                           	JL	L86
   319 000002BA                                 L91:
   320 000002BA 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   321 000002BD 47                              	INC	EDI
   322 000002BE 3B 7A 0C                        	CMP	EDI,DWORD [12+EDX]
   323 000002C1 0F 8E FFFFFF63                  	JLE	L87
   324 000002C7                                 L89:
   325 000002C7 83 C4 18                        	ADD	ESP,24
   326 000002CA 5B                              	POP	EBX
   327 000002CB 5E                              	POP	ESI
   328 000002CC 5F                              	POP	EDI
   329 000002CD 5D                              	POP	EBP
   330 000002CE C3                              	RET
   331 000002CF                                 L95:
   332 000002CF C7 45 10 00000000               	MOV	DWORD [16+EBP],0
   333 000002D6 E9 FFFFFF24                     	JMP	L64
   334 000002DB                                 L94:
   335 000002DB C7 45 0C 00000000               	MOV	DWORD [12+EBP],0
   336 000002E2 E9 FFFFFF0E                     	JMP	L63
   337 000002E7                                 	GLOBAL	_sheet_slide
   338 000002E7                                 _sheet_slide:
   339 000002E7 55                              	PUSH	EBP
   340 000002E8 89 E5                           	MOV	EBP,ESP
   341 000002EA 57                              	PUSH	EDI
   342 000002EB 56                              	PUSH	ESI
   343 000002EC 53                              	PUSH	EBX
   344 000002ED 8B 7D 0C                        	MOV	EDI,DWORD [12+EBP]
   345 000002F0 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   346 000002F3 8B 75 10                        	MOV	ESI,DWORD [16+EBP]
   347 000002F6 8B 4B 0C                        	MOV	ECX,DWORD [12+EBX]
   348 000002F9 8B 53 10                        	MOV	EDX,DWORD [16+EBX]
   349 000002FC 89 7B 0C                        	MOV	DWORD [12+EBX],EDI
   350 000002FF 89 73 10                        	MOV	DWORD [16+EBX],ESI
   351 00000302 83 7B 18 00                     	CMP	DWORD [24+EBX],0
   352 00000306 78 34                           	JS	L96
   353 00000308 6A 00                           	PUSH	0
   354 0000030A 89 D0                           	MOV	EAX,EDX
   355 0000030C 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   356 0000030F 50                              	PUSH	EAX
   357 00000310 89 C8                           	MOV	EAX,ECX
   358 00000312 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   359 00000315 50                              	PUSH	EAX
   360 00000316 52                              	PUSH	EDX
   361 00000317 51                              	PUSH	ECX
   362 00000318 FF 73 20                        	PUSH	DWORD [32+EBX]
   363 0000031B E8 FFFFFEBA                     	CALL	_sheet_refreshsub
   364 00000320 89 F0                           	MOV	EAX,ESI
   365 00000322 FF 73 18                        	PUSH	DWORD [24+EBX]
   366 00000325 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   367 00000328 50                              	PUSH	EAX
   368 00000329 89 F8                           	MOV	EAX,EDI
   369 0000032B 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   370 0000032E 50                              	PUSH	EAX
   371 0000032F 56                              	PUSH	ESI
   372 00000330 57                              	PUSH	EDI
   373 00000331 FF 73 20                        	PUSH	DWORD [32+EBX]
   374 00000334 E8 FFFFFEA1                     	CALL	_sheet_refreshsub
   375 00000339 83 C4 30                        	ADD	ESP,48
   376 0000033C                                 L96:
   377 0000033C 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   378 0000033F 5B                              	POP	EBX
   379 00000340 5E                              	POP	ESI
   380 00000341 5F                              	POP	EDI
   381 00000342 5D                              	POP	EBP
   382 00000343 C3                              	RET
   383 00000344                                 	GLOBAL	_sheet_free
   384 00000344                                 _sheet_free:
   385 00000344 55                              	PUSH	EBP
   386 00000345 89 E5                           	MOV	EBP,ESP
   387 00000347 53                              	PUSH	EBX
   388 00000348 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   389 0000034B 83 7B 18 00                     	CMP	DWORD [24+EBX],0
   390 0000034F 78 0A                           	JS	L99
   391 00000351 6A FF                           	PUSH	-1
   392 00000353 53                              	PUSH	EBX
   393 00000354 E8 FFFFFD4C                     	CALL	_sheet_updown
   394 00000359 58                              	POP	EAX
   395 0000035A 5A                              	POP	EDX
   396 0000035B                                 L99:
   397 0000035B C7 43 1C 00000000               	MOV	DWORD [28+EBX],0
   398 00000362 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
   399 00000365 C9                              	LEAVE
   400 00000366 C3                              	RET
